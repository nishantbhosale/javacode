SQLStream sqlStream = new SQLStream(dataSource);
Stream<ReportData> data = sqlStream.toStream(new SQLQuery(sql.toString(), map), rs -> {
    ReportData d = new ReportData();
    d.setBusinessDate(rs.getDate("BUSINESSDATE") != null ? rs.getDate("BUSINESSDATE").toLocalDate() : null);
    d.setCreation(rs.getTimestamp("CREATION") != null ? rs.getTimestamp("CREATION").toInstant() : null);
    d.setFormat(rs.getString("FORMAT"));
    d.setId(rs.getString("REPORT_ID"));
    d.setName(rs.getString("NAME"));
    d.setReportName(rs.getString("REPORTNAME"));
    d.setBackend(rs.getInt("BACKEND"));
    return d;
});

// Collect report data into a list
List<ReportData> reportDataList = data.collect(Collectors.toList());

// Filter unique report names based on the backend condition
Set<String> uniqueReportNames = new HashSet<>();
List<ReportData> uniqueReportData = new ArrayList<>();
for (ReportData reportData : reportDataList) {
    if (!uniqueReportNames.contains(reportData.getReportName())) {
        uniqueReportNames.add(reportData.getReportName());
        if (reportData.getBackend() == 1) {
            uniqueReportData.add(reportData);
        }
    }
}

// Count the total unique report names satisfying the condition
int total = uniqueReportData.size();

return new ReportDataResult(total, uniqueReportData);
